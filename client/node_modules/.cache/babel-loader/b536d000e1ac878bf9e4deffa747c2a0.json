{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\usuario\\\\Desktop\\\\pruebaTecnica\\\\client\\\\src\\\\contexts\\\\authContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useCallback, useContext, useMemo, useState } from \"react\";\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ROLE = 'role';\nconst NAME = 'name';\nconst EMAIL = 'email';\nconst CREATE = 'createdAt';\nconst ID = 'id';\nconst TK = 'token';\nexport const AuthContext = /*#__PURE__*/createContext();\nexport function AuthContextProvider(_ref) {\n  _s();\n\n  var _window$localStorage$;\n\n  let {\n    children\n  } = _ref;\n  const [isAuthenticated, setIsAuthenticated] = useState((_window$localStorage$ = window.localStorage.getItem(NAME)) !== null && _window$localStorage$ !== void 0 ? _window$localStorage$ : false);\n  const login = useCallback(async function (data) {\n    await axios.post(\"http://localhost:3000/signin\", data, {\n      withCredentials: true\n    }) //{ withCredentials: true }\n    .then(c => {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${c.data.token}`;\n      console.log(\"c\", c.data.user);\n      const role = c.data.user.role.map(i => i.role);\n      window.localStorage.setItem(ROLE, role);\n      window.localStorage.setItem(NAME, c.data.user.name);\n      window.localStorage.setItem(EMAIL, c.data.user.email);\n      window.localStorage.setItem(CREATE, c.data.user.createdAt);\n      window.localStorage.setItem(ID, c.data.user.id);\n      window.localStorage.setItem(TK, c.data.token); // window.localStorage.setItem(TODO,c.data);\n    });\n    setIsAuthenticated(true);\n  }, []);\n  const logout = useCallback(function () {\n    window.localStorage.removeItem(NAME);\n    window.localStorage.removeItem(EMAIL);\n    window.localStorage.removeItem(CREATE);\n    window.localStorage.removeItem(ID);\n    setIsAuthenticated(false);\n  }, []);\n  const value = useMemo(() => ({\n    login,\n    logout,\n    isAuthenticated\n  }), [login, logout, isAuthenticated]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 12\n  }, this);\n}\n\n_s(AuthContextProvider, \"RQoRNgbNW3iH58bOf6CqEX6xGvw=\");\n\n_c = AuthContextProvider;\n; // AuthContextProvider.propTypes = {\n//     children: PropTypes.object\n// };\n\nexport function useAuthContext() {\n  _s2();\n\n  return useContext(AuthContext);\n}\n\n_s2(useAuthContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useCallback","useContext","useMemo","useState","axios","ROLE","NAME","EMAIL","CREATE","ID","TK","AuthContext","AuthContextProvider","children","isAuthenticated","setIsAuthenticated","window","localStorage","getItem","login","data","post","withCredentials","then","c","defaults","headers","common","token","console","log","user","role","map","i","setItem","name","email","createdAt","id","logout","removeItem","value","useAuthContext"],"sources":["C:/Users/usuario/Desktop/pruebaTecnica/client/src/contexts/authContext.js"],"sourcesContent":["import {createContext, useCallback, useContext, useMemo, useState} from \"react\";\r\nimport axios from 'axios';\r\n\r\nconst ROLE ='role'\r\nconst NAME ='name'\r\nconst EMAIL ='email'\r\nconst CREATE ='createdAt'\r\nconst ID ='id'\r\nconst TK ='token'\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport function AuthContextProvider({children}){\r\n    const [isAuthenticated, setIsAuthenticated] = useState(window.localStorage.getItem(NAME)??false);\r\n\r\n    const login = useCallback(async function(data){\r\n        await axios.post(\"http://localhost:3000/signin\" , data , {withCredentials: true}  )//{ withCredentials: true }\r\n        .then((c)=>{\r\n            axios.defaults.headers.common['Authorization']=`Bearer ${c.data.token}`;\r\n            console.log(\"c\", c.data.user);\r\n            const role = c.data.user.role.map(i=>i.role)\r\n            window.localStorage.setItem(ROLE,role);\r\n            window.localStorage.setItem(NAME,c.data.user.name);\r\n            window.localStorage.setItem(EMAIL,c.data.user.email);\r\n            window.localStorage.setItem(CREATE,c.data.user.createdAt);\r\n            window.localStorage.setItem(ID,c.data.user.id);\r\n            window.localStorage.setItem(TK,c.data.token);\r\n            // window.localStorage.setItem(TODO,c.data);\r\n            \r\n        })\r\n        setIsAuthenticated(true);\r\n    },[])\r\n\r\n    const logout = useCallback(function(){\r\n        window.localStorage.removeItem(NAME);\r\n        window.localStorage.removeItem(EMAIL);\r\n        window.localStorage.removeItem(CREATE);\r\n        window.localStorage.removeItem(ID);\r\n        setIsAuthenticated(false);\r\n    },[])\r\n\r\n    const value = useMemo(\r\n        ()=> ({\r\n            login,\r\n            logout,\r\n            isAuthenticated\r\n        }) ,[login,logout,isAuthenticated]\r\n    );\r\n\r\n    return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\n// AuthContextProvider.propTypes = {\r\n//     children: PropTypes.object\r\n// };\r\n\r\nexport function useAuthContext() {\r\n    return useContext(AuthContext);\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}